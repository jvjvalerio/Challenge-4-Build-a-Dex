"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useObservableInternal = void 0;
var rxjs_1 = require("rxjs");
var helpers_1 = require("../helpers");
var react_1 = require("react");
/**
 * @template TOutput Output value within Observable.
 * @template TInputs An readonly tuple of all dependencies.
 *
 * @param useCustomEffect useEffect or useLayoutEffect
 * @param init A pure function that, when applied to an Observable,
 * returns an Observable.
 * @param inputs An dependency array with fixed length. When one of the dependencies
 * changes the Observable in `init` will emit an array of all the dependencies.
 */
function useObservableInternal(useCustomEffect, init, inputs) {
    if (!inputs) {
        return helpers_1.useRefFn(init).current;
    }
    var inputs$Ref = helpers_1.useRefFn(function () { return new rxjs_1.BehaviorSubject(inputs); });
    var source$Ref = helpers_1.useRefFn(function () { return init(inputs$Ref.current); });
    var firstEffectRef = react_1.useRef(true);
    useCustomEffect(function () {
        if (firstEffectRef.current) {
            firstEffectRef.current = false;
            return;
        }
        inputs$Ref.current.next(inputs);
    }, inputs);
    return source$Ref.current;
}
exports.useObservableInternal = useObservableInternal;
//# sourceMappingURL=use-observable-internal.js.map